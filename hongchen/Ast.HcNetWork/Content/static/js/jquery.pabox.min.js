!function(t,e,n,o){function i(e,n){this.settings=t.extend(!0,{},a,n),this.$element=t(e),this.$box=null,this.$items=null,this.idx=0,this.init()}function s(e,n,o){var i=t('<img class="pabox-content"  src="'+e.attr("href")+'" />');return i.load(o)}var a={selector:null,prev:"&lt;",next:"&gt;",loading:"%",close:"&times;",speed:400,zIndex:1e3,cycle:!0,captionAttr:"title",template:"image",templates:{image:s}};i.prototype.init=function(){var t=this;return t.$element.on("click.pabox",t.settings.selector,function(e){e.preventDefault(),t.open(this)})},i.prototype.open=function(o){var i=this;return i.$items=null===i.settings.selector?i.$element:i.$element.find(i.settings.selector),isNaN(o)&&(o=i.$items.index(o)),i.$box=t('<div class="pabox" style="display:none;"><a href="#" class="pabox-close pabox-button">'+i.settings.close+'</a><a href="#" class="pabox-prev pabox-button">'+i.settings.prev+'</a><a href="#" class="pabox-next pabox-button">'+i.settings.next+'</a><div class="pabox-contents"></div><div class="pabox-caption"><p></p></div></div>').appendTo("body").css("zIndex",i.settings.zIndex).fadeIn(i.settings.speed).on("click.pabox",".pabox-close",function(t){t.preventDefault(),i.close()}).on("click.pabox",".pabox-next",function(t){t.preventDefault(),i.next()}).on("click.pabox",".pabox-prev",function(t){t.preventDefault(),i.prev()}),t(n).on("swipeLef_this.pabox",function(){i.next()}).on("swipeRigh_this.pabox",function(){i.prev()}).on("keydown.pabox",function(t){t.preventDefault();var n=e.event?t.keyCode:t.keyCode;switch(n){case 27:i.close();break;case 37:i.prev();break;case 39:i.next()}}),i.$element.trigger("pabox:open",[i]),i.goto(o),i.$element},i.prototype.close=function(){var e=this;return e.$box&&e.$box.length&&e.$box.fadeOut(e.settings.speed,function(){e.$box.remove(),e.$box=null,e.$element.trigger("pabox:close",[e])}),t(n).off(".pabox"),e.$element},i.prototype.goto=function(e){var n=this,o=t(n.$items[e]),i=o.attr(n.settings.captionAttr),s=(n.$box.children(".pabox-caption")[i?"show":"hide"]().children("p").text(i),n.$box.children(".pabox-contents")),a=null;return o.length&&(n.idx=e,s.html('<div class="pabox-loading pabox-button">'+n.settings.loading+"</div>"),a=n.settings.templates[o.data("pabox-template")||n.settings.template](o,n.settings,function(){var e=s.empty().append(t(this)),n=e.children("img");n.css({display:"block",position:"absolute",top:"50%",left:"50%",marginTop:-(n[0].offsetHeight/2),marginLeft:-(n[0].offsetWidth/2)})}),1!=n.$items.length&&n.settings.cycle||(n.$box.children(".pabox-prev")[0>=e?"hide":"show"](),n.$box.children(".pabox-next")[e>=n.$items.length-1?"hide":"show"]()),n.$element.trigger("pabox:goto",[n,e,o,a])),n.$element},i.prototype.prev=function(){var t=this;return t.goto(0===t.idx?t.$items.length-1:t.idx-1)},i.prototype.next=function(){var t=this;return t.goto(t.idx===t.$items.length-1?0:t.idx+1)},i.prototype.disable=function(){var t=this;return t.close().off(".pabox").trigger("pabox:disable",[t])},i.prototype.destroy=function(){var t=this;return t.disable().removeData("pabox").trigger("pabox:destroy")},i.prototype.option=function(t,e){var n=this;return e!==o?(n.settings[t]=e,n.disable().enable()):n.settings[t]},t.fn.pabox=function(e){return this.each(function(){t.data(this,"plugin_pabox")||t.data(this,"plugin_pabox",new i(this,e))})}}(jQuery,window,document);